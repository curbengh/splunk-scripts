# Patches for [Splunk_TA_windows](https://splunkbase.splunk.com/app/742)

## Additional fields extraction for Splunk_TA_windows

Field extraction/transformation on output log of [`Get-WindowsUpdateLog`](https://learn.microsoft.com/en-us/powershell/module/windowsupdate/get-windowsupdatelog) launched by "Splunk_TA_windows/bin/powershell/generate_windows_update_logs.ps1". Since Windows Server 2016 and Windows 10, Windows Update log is no longer available at "C:\Windows\WindowsUpdate.log".

The field extraction is also necessary to map to [Updates](https://docs.splunk.com/Documentation/CIM/latest/User/Updates) data model.

## Map account events to [Change](https://docs.splunk.com/Documentation/CIM/latest/User/Change) data model

Include event code [>=5136](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/) generated by Active Directory account changes.

## Map network share events to [Endpoint Filesystem](https://docs.splunk.com/Documentation/CIM/latest/User/Endpoint#Filesystem) data model

Include event code 5140, 5142, 5145 generated by network share.

## Blacklist regex compatible with XML format

The default blacklist for `WinEventLog://Security` (as of 8.8.0) is still incompatible with XML-formatted event, even though the addon had switched from classic to XML since since 6.0.0 (8.2.0 was released in [8 Oct 2021](http://web.archive.org/web/20211026131020/https://docs.splunk.com/Documentation/AddOns/released/Windows/Releasenote)).

[inputs.conf](./inputs.conf) has been updated to support XML.

## Build

```
build.py [--input] /path/to/splunk-add-on-for-microsoft-windows_*.tgz [--cloud]
```

Options:

- **input**: Path to Splunk app. (default: "splunk-add-on-for-microsoft-windows\_\*.tgz" in the current directory)
- **cloud**: Create Splunk Cloud-compatible app.

Outputs:

- Splunk_TA_windows\_\*.tgz
- custom-Splunk_TA_windows\_\*.tgz (if `--cloud` is specified)
  - This should be installed alongside the Splunk_TA_windows from [Splunkbase](https://splunkbase.splunk.com/app/742)
