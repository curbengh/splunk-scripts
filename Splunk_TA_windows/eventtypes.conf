[eventlog_Update_Failed]
search =  source IN ("WinEventLog:System", "WMI:WinEventLog:System", "XmlWinEventLog:System") "Installation Failure"

[eventlog_Update_Successful]
search =  eventtype IN ("msperfmon-index", "wineventlog-index") source IN ("WinEventLog:System", "WMI:WinEventLog:System", "XmlWinEventLog:System") "Installation Successful"

[eventlog_Update_Successful_windows]
search =  source IN ("WinEventLog:System", "WMI:WinEventLog:System", "XmlWinEventLog:System") "Installation Successful"

# see windows_updatelog_status
[updatelog_Update_Failed]
search = sourcetype="WindowsUpdateLog" Failure ("Content Install" OR ("Title" AND "KB*")) "Installation Failure"

[updatelog_Update_Successful]
search = eventtype=windows-index sourcetype="WindowsUpdateLog" ("Content Install" OR ("Title" AND "KB*")) "Installation Successful"

[updatelog_Update_Successful_windows]
search = sourcetype="WindowsUpdateLog" ("Content Install" OR ("Title" AND "KB*")) "Installation Successful"

# ("Title" AND "KB*") is added to the default to ingest  "$SplunkHome\var\log\Splunk_TA_windows\WindowsUpdate.log" generated by "$SplunkHome\etc\apps\Splunk_TA_windows_workstations\bin\powershell\generate_windows_update_logs.ps1". The default ("Content Install") only matches "$env:WINDIR\WindowsUpdate.log"
# "$env:WINDIR\WindowsUpdate.log" is no longer available on Windows 10/Server 2016
[windows_updatelog_status]
search = sourcetype=WindowsUpdateLog ("Content Install" OR ("Title" AND "KB*")) NOT "Download Succeeded" NOT "Reboot Completed" NOT "Hide Update"

# https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/
[msad-computer-changes]
disabled = 0
search = eventtype=wineventlog_security EventCode IN (4741, 4742, 4743) OR (EventCode IN (5136, 5137, 5138, 5139, 5141) ObjectClass=computer)

[msad-user-changes]
disabled = 0
search = eventtype=wineventlog_security EventCode IN (4720, 4722, 4724, 4725, 4726, 4738, 4767, 4781, 4912) OR (EventCode IN (5136, 5137, 5138, 5139, 5141) ObjectClass IN (user, group)) user!="*$"

[windows_account_created]
disabled = 0
search = eventtype=wineventlog_security EventCode IN (4720, 4741, 624, 645) OR (EventCode=5137 ObjectClass IN (user, group))

[windows_account_deleted]
disabled = 0
search = eventtype=wineventlog_security EventCode IN (4726, 4743, 630, 647) OR (EventCode=5141 ObjectClass IN (user, group))

[windows_account_modified]
disabled = 0
search = eventtype=wineventlog_security EventCode IN (4738, 4742, 642, 646, 625) OR (EventCode=5136 ObjectClass IN (user, group))

## Endpoint Filesystem
[windows_endpoint_filesystem]
search = eventtype=wineventlog_security EventCode IN (5140, 5142, 5145)

[windows_security_change_account]
disabled = 0
search = eventtype=wineventlog_security EventCode IN (4634, 4703, 4704, 4705, 4720, 4722, 4723, 4724, 4725, 4726, 4732, 4738, 4740, 4767, 4781, 4800, 4801) OR (EventCode IN (5136, 5137, 5138, 5139, 5141) ObjectClass IN (user, group))
