# search-time field extraction
# deploy to search head or Splunk Cloud
# parse logs generated by Get-WindowsUpdateLog
# $SPLUNK_HOME\\var\\log\\Splunk_TA_windows\\WindowsUpdate.log
[source::...\\var\\log\\Splunk_TA_windows\\WindowsUpdate.log]
REPORT-0signature_for_windowsupdatelog_ta = signature_for_windowsupdatelog_ta

[source::XmlWinEventLog:Security]
# https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624#logon-types-and-descriptions
LOOKUP-eventcode_4624 = xmlsecurity_eventcode_4624 logon_type AS LogonType OUTPUT logon_title AS authentication_title, description AS authentication_signature
# https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4776
LOOKUP-eventcode_4776 = xmlsecurity_eventcode_4776 error_code AS Status OUTPUT description AS authentication_signature
EVAL-authentication_signature_id = coalesce(LogonType, Status)

# Endpoint Services CIM Mapping
[source::XmlWinEventLog:System]
# https://www.manageengine.com/products/active-directory-audit/kb/system-events/event-id-7045.html
REPORT-service_process_path_exec = extract_service_process_path_exec
LOOKUP-signature = windows_signatures_system signature_id OUTPUTNEW signature, signature AS name, action

[XmlWinEventLog]
EVAL-user_id = trim(UserID, "'\"")
LOOKUP-user_id = windows_sid user_id OUTPUTNEW user, user AS user_name
